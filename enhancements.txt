added enhancements from feature branch
